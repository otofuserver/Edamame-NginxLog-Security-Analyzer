# mini_menu.js

対象: `src/main/resources/static/mini_menu.js`

## 概要
- サーバー管理・URL脅威度など複数画面で再利用する共通ミニメニューパーツのJSロジック。
- クリック位置近くにミニメニューを表示し、外側クリックや Escape で閉じる挙動を統一する。

## 主な機能
- 指定ターゲット要素に対するミニメニュー表示/非表示の制御。
- クリック座標に基づいた表示位置計算とViewport内へのクリッピング。
- 外側クリック・Escapeキーでのクローズ処理（毎回復帰するため一度きりで終わらない）。
- aria-hidden/inert を用いたフォーカス管理の配慮（フォーカス中要素は hidden にしない）。

## 挙動
- `openMenu(menuElement, x, y)` で座標を指定して表示し、`closeMenu(menuElement)` で非表示にする。
- メニュー内クリックは閉じないが、他行クリック時は一度閉じてから新規に開く。
- `document` レベルのクリッ���/keydown リスナーで一度しか動かない問題を解消し、毎回イベントを再登録する。

## 細かい指定された仕様
- aria 警告対策として、フォーカスが当たる要素やその祖先に `aria-hidden="true"` を付与しない。必要に応じて `inert` で操作抑止のみを行う。
- z-index を 1700 で統一し、重複表示時も同階層で制御。
- 位置計算はメニュー幅/高さを考慮し、画面外に出ないよう補正する。

## その他
- スタイルは `style.css` 側の `.sidebar-mini-menu` / `.mini-menu-item` クラスを利用。

## 変更履歴
- 2026-01-15: 共通ミニメニューを独立ファイル化し、外側クリックが一度しか動かない問題と aria-hidden 警告を解消。
